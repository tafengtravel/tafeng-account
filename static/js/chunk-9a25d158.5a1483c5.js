(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9a25d158"],{"2a70":function(e,t,l){},8317:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"app-container"},[l("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"選擇日期","value-format":"yyyy-MM-dd"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),l("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"請輸入團名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),l("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜尋")]),l("div",{staticClass:"el-col-24"},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"show-summary":"","summary-method":e.getSummaries,data:e.itemData,"row-class-name":e.tableRowClassName,"empty-text":"沒有資料"}},[l("el-table-column",{attrs:{type:"index",label:"筆數",width:"75%",fixed:""}}),l("el-table-column",{attrs:{prop:"number",label:"團號",width:"140%",sortable:"","sort-method":function(e,t){return e.number.localeCompare(t.number)}}}),l("el-table-column",{attrs:{prop:"cs",label:"客服",width:"80%"}}),l("el-table-column",{attrs:{prop:"depDate",label:"出發日期",width:"120%",sortable:"","sort-method":function(e,t){return e.depDate.localeCompare(t.depDate)}}}),l("el-table-column",{attrs:{prop:"endDate",label:"結束日期",width:"120%",sortable:"","sort-method":function(e,t){return e.endDate.localeCompare(t.endDate)}}}),l("el-table-column",{attrs:{prop:"name",label:"團名",sortable:"","sort-method":function(e,t){return e.name.localeCompare(t.name)}}}),l("el-table-column",{attrs:{prop:"people",label:"代表人",width:"125%",sortable:"","sort-method":function(e,t){return e.people.localeCompare(t.people)}}}),l("el-table-column",{attrs:{prop:"amount",label:"人數",width:"90%",sortable:"","sort-method":function(e,t){return e.amount.localeCompare(t.amount)}}}),l("el-table-column",{attrs:{prop:"phone",label:"聯絡電話",width:"125%",sortable:"","sort-method":function(e,t){return e.phone-t.phone}}}),l("el-table-column",{attrs:{prop:"income",label:"總收入",width:"90%"}}),l("el-table-column",{attrs:{prop:"incomeDetailIncome",label:"收入",width:"90%"}}),l("el-table-column",{attrs:{prop:"incomeDetailType",label:"收款方式",width:"100%"}}),l("el-table-column",{attrs:{prop:"priceInsufficient",label:"未收尾款",width:"110%"}}),l("el-table-column",{attrs:{prop:"other",label:"備註"}}),l("el-table-column",{attrs:{prop:"",label:"編輯",width:"60%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text"},on:{click:function(l){return e.edit(t.row)}}},[e._v("編輯")])]}}])})],1),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"show-summary":"","summary-method":e.getSummaries,data:e.itemDataRefund,"row-class-name":e.tableRowClassName,"empty-text":"沒有資料"}},[l("el-table-column",{attrs:{type:"index",label:"筆數",width:"75%",fixed:""}}),l("el-table-column",{attrs:{prop:"number",label:"團號",width:"140%",sortable:"","sort-method":function(e,t){return e.number.localeCompare(t.number)}}}),l("el-table-column",{attrs:{prop:"cs",label:"客服",width:"80%"}}),l("el-table-column",{attrs:{prop:"depDate",label:"出發日期",width:"120%",sortable:"","sort-method":function(e,t){return e.depDate.localeCompare(t.depDate)}}}),l("el-table-column",{attrs:{prop:"endDate",label:"結束日期",width:"120%",sortable:"","sort-method":function(e,t){return e.endDate.localeCompare(t.endDate)}}}),l("el-table-column",{attrs:{prop:"name",label:"團名",sortable:"","sort-method":function(e,t){return e.name.localeCompare(t.name)}}}),l("el-table-column",{attrs:{prop:"people",label:"代表人",width:"125%",sortable:"","sort-method":function(e,t){return e.people.localeCompare(t.people)}}}),l("el-table-column",{attrs:{prop:"amount",label:"人數",width:"90%",sortable:"","sort-method":function(e,t){return e.amount.localeCompare(t.amount)}}}),l("el-table-column",{attrs:{prop:"phone",label:"聯絡電話",width:"125%",sortable:"","sort-method":function(e,t){return e.phone-t.phone}}}),l("el-table-column",{attrs:{prop:"income",label:"總收入",width:"90%"}}),l("el-table-column",{attrs:{prop:"refundDetailRefund",label:"退款",width:"90%"}}),l("el-table-column",{attrs:{prop:"refundDetailType",label:"退款方式",width:"100%"}}),l("el-table-column",{attrs:{prop:"priceInsufficient",label:"未收尾款",width:"110%"}}),l("el-table-column",{attrs:{prop:"other",label:"備註"}}),l("el-table-column",{attrs:{prop:"",label:"編輯",width:"60%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text"},on:{click:function(l){return e.edit(t.row)}}},[e._v("編輯")])]}}])})],1)],1),l("div",{staticClass:"el-col-24"},[l("el-row"),l("span",{staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("總收入："+e._s(e.incomeTotal))]),l("span",{staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("總退款："+e._s(e.refundTotal))]),l("span",{staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold"}},[e._v("總人數："+e._s(e.amountTotal))])],1),l("div",{staticClass:"el-col-24"},[l("el-row"),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("收入 匯款："+e._s(e.transfer))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("現金："+e._s(e.cash))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("刷卡："+e._s(e.card))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("支票："+e._s(e.check))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("其他："+e._s(e.other))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("五倍券："+e._s(e.coupon))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("LINEPAY："+e._s(e.linepay))])],1),l("div",{staticClass:"el-col-24"},[l("el-row"),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("退款 轉帳/匯款："+e._s(e.refundTransfer))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("郵局："+e._s(e.refundPost))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("刷卡："+e._s(e.refundCard))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("現金："+e._s(e.refundCash))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("支票："+e._s(e.refundCheck))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("LINEPAY："+e._s(e.refundLinepay))]),l("el-col",{staticClass:"el-col-xl-3 el-col-lg-3 el-col-md-8 el-col-sm-8 el-col-xs-12",staticStyle:{"font-size":"15px","font-family":"Microsoft JhengHei","font-weight":"bold","padding-right":"30px"}},[e._v("其他："+e._s(e.refundOther))])],1)],1)},o=[],n=l("5530"),i=(l("d3b7"),l("159b"),l("d81d"),l("a434"),l("b0c0"),l("17e1")),r=(l("2a70"),l("c1df")),s={components:{},data:function(){return{listLoading:!1,itemData:[],itemDataRefund:[],date:"",name:"",incomeTotal:0,refundTotal:0,amountTotal:0,transfer:0,cash:0,card:0,check:0,other:0,coupon:0,linepay:0,refundTransfer:0,refundPost:0,refundCard:0,refundCash:0,refundCheck:0,refundLinepay:0,refundOther:0}},created:function(){},methods:{getSummaries:function(e){var t=e.columns,l=e.data,a=[];return t.forEach((function(e,t){if(0!==t)if("人數"==e.label||"收入"==e.label||"退款"==e.label){var o=l.map((function(t){return parseInt(t[e.property])}));o.every((function(e){return isNaN(e)}))||(a[t]=o.reduce((function(e,t){var l=parseInt(t);return isNaN(l)?e:e+t}),0))}else a[t]="";else a[t]="總共"})),a},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2===1?"color-row":""},search:function(){var e=this;this.listLoading=!0;var t=i["a"].collection(r(this.date).format("YYYY-MM")),l=0;this.incomeTotal=0,this.refundTotal=0,this.amountTotal=0,this.itemData.splice(0,this.itemData.length),this.itemDataRefund.splice(0,this.itemDataRefund.length),this.transfer=0,this.card=0,this.cash=0,this.check=0,this.other=0,this.coupon=0,this.linepay=0,this.refundTransfer=0,this.refundPost=0,this.refundCard=0,this.refundCash=0,this.refundCheck=0,this.refundOther=0,this.refundLinepay=0,t.where("depDate","==",this.date).get().then((function(t){t.forEach((function(t){if(console.log(t.data()),t.data().name==e.name){e.incomeTotal=e.incomeTotal+parseInt(t.data().income),e.amountTotal=e.amountTotal+parseInt(t.data().amount),l=parseInt(t.data().price)-parseInt(t.data().income);for(var a=0;a<t.data().incomeDetailIncome.length;a++)e.itemData.push(Object(n["a"])(Object(n["a"])({},t.data()),{},{priceInsufficient:l,incomeDetailIncome:t.data().incomeDetailIncome[a],incomeDetailType:t.data().incomeDetailType[a]})),"匯款"==t.data().incomeDetailType[a]?e.transfer=e.transfer+parseInt(t.data().incomeDetailIncome[a]):"刷卡"==t.data().incomeDetailType[a]?e.card=e.card+parseInt(t.data().incomeDetailIncome[a]):"現金"==t.data().incomeDetailType[a]?e.cash=e.cash+parseInt(t.data().incomeDetailIncome[a]):"支票"==t.data().incomeDetailType[a]?e.check=e.check+parseInt(t.data().incomeDetailIncome[a]):"其他"==t.data().incomeDetailType[a]?e.other=e.other+parseInt(t.data().incomeDetailIncome[a]):"五倍券"==t.data().incomeDetailType[a]?e.coupon=e.coupon+parseInt(t.data().incomeDetailIncome[a]):"LINEPAY"==t.data().incomeDetailType[a]&&(e.linepay=e.linepay+parseInt(t.data().incomeDetailIncome[a]));for(var o=0;o<t.data().refundDetailRefund.length;o++)e.refundTotal=e.refundTotal+parseInt(t.data().refundDetailRefund[o]),e.itemDataRefund.push(Object(n["a"])(Object(n["a"])({},t.data()),{},{priceInsufficient:l,refundDetailRefund:t.data().refundDetailRefund[o],refundDetailType:t.data().refundDetailType[o]})),"轉帳"==t.data().refundDetailType[o]||"匯款"==t.data().refundDetailType[o]?e.refundTransfer=e.refundTransfer+parseInt(t.data().refundDetailRefund[o]):"郵局"==t.data().refundDetailType[o]?e.refundPost=e.refundPost+parseInt(t.data().refundDetailRefund[o]):"刷卡"==t.data().refundDetailType[o]?e.refundCard=e.refundCard+parseInt(t.data().refundDetailRefund[o]):"現金"==t.data().refundDetailType[o]?e.refundCash=e.refundCash+parseInt(t.data().refundDetailRefund[o]):"支票"==t.data().refundDetailType[o]?e.refundCheck=e.refundCheck+parseInt(t.data().refundDetailRefund[o]):"LINEPAY"==t.data().refundDetailType[o]?e.refundLinepay=e.refundLinepay+parseInt(t.data().refundDetailRefund[o]):"其他"==t.data().refundDetailType[o]&&(e.refundOther=e.refundOther+parseInt(t.data().refundDetailRefund[o]))}}))})),this.listLoading=!1},edit:function(e){console.log(e);var t=this.$router.resolve({path:"/op/edit",query:{number:e.number,depDate:r(this.date).format("YYYY-MM")}});window.open(t.href,"_blank")}},mounted:function(){}},c=s,d=l("2877"),p=Object(d["a"])(c,a,o,!1,null,null,null);t["default"]=p.exports},a434:function(e,t,l){"use strict";var a=l("23e7"),o=l("23cb"),n=l("a691"),i=l("50c4"),r=l("7b0b"),s=l("65f0"),c=l("8418"),d=l("1dde"),p=l("ae40"),f=d("splice"),u=p("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!u},{splice:function(e,t){var l,a,d,p,f,u,y=r(this),x=i(y.length),w=o(e,x),D=arguments.length;if(0===D?l=a=0:1===D?(l=0,a=x-w):(l=D-2,a=h(m(n(t),0),x-w)),x+l-a>b)throw TypeError(g);for(d=s(y,a),p=0;p<a;p++)f=w+p,f in y&&c(d,p,y[f]);if(d.length=a,l<a){for(p=w;p<x-a;p++)f=p+a,u=p+l,f in y?y[u]=y[f]:delete y[u];for(p=x;p>x-a+l;p--)delete y[p-1]}else if(l>a)for(p=x-a;p>w;p--)f=p+a-1,u=p+l-1,f in y?y[u]=y[f]:delete y[u];for(p=0;p<l;p++)y[p+w]=arguments[p+2];return y.length=x-a+l,d}})}}]);