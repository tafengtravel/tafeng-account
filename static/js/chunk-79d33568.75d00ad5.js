(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79d33568"],{"2a70":function(t,e,a){},"2cb3":function(t,e,a){"use strict";a("8d9f")},"3de1":function(t,e,a){},"8d9f":function(t,e,a){},dd57:function(t,e,a){"use strict";a("3de1")},ecac:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-container"},[a("div",{staticClass:"dashboard-text"}),a("el-form",{staticClass:"demo-ruleForm",attrs:{model:t.form,inline:!0,"label-position":"left","label-width":"70px"}},[a("el-row",{attrs:{gutter:30}},[a("div",{staticClass:"sub_title"},[t._v("基本資料")])]),a("el-row",{attrs:{gutter:16}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-skeleton",{staticStyle:{width:"240px"},attrs:{loading:t.listLoading,animated:""}},[a("template",{slot:"template"},[a("el-skeleton-item",{staticStyle:{width:"40%"},attrs:{variant:"text"}})],1),[a("span",{staticClass:"form-font-md font"},[t._v(t._s(t.form.name))])]],2)],1),a("el-form-item",{attrs:{label:"代號"}},[a("el-skeleton",{staticStyle:{width:"240px"},attrs:{loading:t.listLoading,animated:""}},[a("template",{slot:"template"},[a("el-skeleton-item",{staticStyle:{width:"60%"},attrs:{variant:"text"}})],1),[a("span",{staticClass:"form-font-md font"},[t._v(t._s(t.form.cs))])]],2)],1),a("el-form-item",{attrs:{label:"信箱"}},[a("el-skeleton",{staticStyle:{width:"240px"},attrs:{loading:t.listLoading,animated:""}},[a("template",{slot:"template"},[a("el-skeleton-item",{staticStyle:{width:"80%"},attrs:{variant:"text"}})],1),[a("span",{staticClass:"form-font-md font"},[t._v(t._s(t.form.mail))])]],2)],1)],1),a("el-row",{attrs:{gutter:16}},[a("el-form-item",{attrs:{label:"日期"}},[a("el-skeleton",{staticStyle:{width:"240px"},attrs:{loading:t.listLoading,animated:""}},[a("template",{slot:"template"},[a("el-skeleton-item",{staticStyle:{width:"80%"},attrs:{variant:"text"}})],1),[a("span",{staticClass:"form-font-md font"},[t._v(t._s(t.date))])]],2)],1),a("el-form-item",{attrs:{label:"上班簽到","label-width":"110px"}},[a("el-skeleton",{staticStyle:{width:"200px"},attrs:{loading:t.listLoading,animated:""}},[a("template",{slot:"template"},[a("el-skeleton-item",{staticStyle:{width:"80%"},attrs:{variant:"text"}})],1),[t.formRecord.entryTimeDisable||t.listLoading?a("span",{staticClass:"form-font-md font"},[t._v(t._s(t.formRecord.entryTime))]):a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.submitCheck("entry")}}},[t._v("簽到")])]],2)],1),a("el-form-item",{attrs:{label:"下班簽到","label-width":"110px"}},[a("el-skeleton",{staticStyle:{width:"200px"},attrs:{loading:t.listLoading,animated:""}},[a("template",{slot:"template"},[a("el-skeleton-item",{staticStyle:{width:"80%"},attrs:{variant:"text"}})],1),[t.formRecord.quitTimeDisable||t.listLoading?a("span",{staticClass:"form-font-md font"},[t._v(t._s(t.formRecord.quitTime))]):a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.submitCheck("quit")}}},[t._v("簽到")])]],2)],1)],1),a("el-row",{attrs:{gutter:30}},[a("div",{staticClass:"sub_title"},[t._v("出缺勤紀錄")])]),a("el-row",{attrs:{gutter:16}},[a("el-form-item",{attrs:{label:"月份","label-width":"70px"}},[a("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"month","value-format":"yyyy-MM",placeholder:"選擇日期"},model:{value:t.monthSearch,callback:function(e){t.monthSearch=e},expression:"monthSearch"}})],1),a("el-button",{attrs:{type:"primary",loading:t.listLoading},on:{click:function(e){return t.searchRecord()}}},[t._v("搜尋")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.itemData,"default-sort":{prop:"date",order:"ascending"},"row-class-name":t.tableRowClassName,"empty-text":"沒有資料"}},[a("el-table-column",{attrs:{type:"index",label:"筆數",width:"75%",fixed:""}}),a("el-table-column",{attrs:{prop:"date",label:"日期",width:"140%",sortable:"","sort-method":function(t,e){return t.date-e.date}}}),a("el-table-column",{attrs:{prop:"week",label:"星期",width:"140%",sortable:"","sort-method":function(t,e){return t.date-e.date}}}),a("el-table-column",{attrs:{prop:"name",label:"姓名",sortable:"","sort-method":function(t,e){return t.name.localeCompare(e.name)}}}),a("el-table-column",{attrs:{prop:"entryTime",label:"上班時間",width:"140%",sortable:"","sort-method":function(t,e){return t.entryTime-e.entryTime}}}),a("el-table-column",{attrs:{prop:"quitTime",label:"下班時間",width:"140%",sortable:"","sort-method":function(t,e){return t.quitTime-e.quitTime}}})],1)],1)},n=[],o=a("1da1"),i=a("5530"),s=(a("96cf"),a("a434"),a("d3b7"),a("159b"),a("b0c0"),a("17e1")),l=a("2f62"),c=(a("bc3a"),a("c1df")),m=(a("2a70"),a("096e")),d=a.n(m),u={name:"Dashboard",data:function(){return{email:"",form:{},formRecord:{date:"",month:"",entryTime:"",quitTime:"",name:"",entryTimeDisable:"",quitTimeDisable:"",entryDevice:{},quitDevice:{}},listLoading:!0,date:c(new Date).format("YYYY-MM-DD"),itemData:[],monthSearch:c(new Date).format("YYYY-MM")}},computed:Object(i["a"])({},Object(l["b"])(["name"])),methods:{searchRecord:function(){var t=this,e=s["a"].collection("human-resources").doc(this.form.number).collection("record");e.where("month","==",this.monthSearch).onSnapshot((function(e){t.itemData.splice(0,t.itemData.length),e.forEach((function(e){t.itemData.push(Object(i["a"])(Object(i["a"])({},e.data()),{},{week:c(e.data().date).locale("zh-TW").format("dddd")}))}))}))},readRecord:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=s["a"].collection("human-resources").doc(t.form.number).collection("record").doc(c(new Date).format("YYYY-MM-DD")),e.next=3,a.onSnapshot((function(e){t.formRecord=Object(i["a"])(Object(i["a"])({},t.formRecord),e.data()),t.listLoading=!1}));case 3:case"end":return e.stop()}}),e)})))()},submitCheck:function(t){var e=this;this.$confirm("是否進行打卡簽到","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"success"}).then((function(){e.submit(t)})).catch((function(){e.$message({type:"info",message:"已取消簽到"})}))},submit:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,fetch("https://api.ipify.org/").then((function(t){return t.text()})).catch((function(t){return alert(t)}));case 2:r=a.sent,console.log(r),"218.161.104.58"==r?("entry"==t?e.formRecord=Object(i["a"])(Object(i["a"])({},e.formRecord),{},{entryTimeDisable:!0,entryTime:c(new Date).format("HH:mm:ss"),entryDevice:(new d.a).parse(window.navigator.userAgent).device}):"quit"==t&&(e.formRecord=Object(i["a"])(Object(i["a"])({},e.formRecord),{},{quitTimeDisable:!0,quitTime:c(new Date).format("HH:mm:ss"),quitDevice:(new d.a).parse(window.navigator.userAgent).device})),e.formRecord=Object(i["a"])(Object(i["a"])({},e.formRecord),{},{date:c(new Date).format("YYYY-MM-DD"),name:e.form.name,month:c(new Date).format("YYYY-MM")}),n=s["a"].collection("human-resources").doc(e.form.number).collection("record").doc(c(new Date).format("YYYY-MM-DD")),n.set(e.formRecord).then((function(){console.log("set data successful"),e.$message.success("打卡成功"),e.$router.push({path:"/profile"})}))):e.$message.error("IP錯誤！請使用公司WIFI或電腦進行打卡！");case 5:case"end":return a.stop()}}),a)})))()},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"color-row":""}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["b"].auth().onAuthStateChanged((function(e){e&&(t.email=e.email)}));case 2:return a=s["a"].collection("human-resources"),e.next=5,a.where("mail","==",t.email).where("active","==",!0).get().then((function(e){e.forEach((function(e){t.form=e.data()})),t.readRecord(),t.searchRecord()}));case 5:case"end":return e.stop()}}),e)})))()}},f=u,h=(a("dd57"),a("2cb3"),a("2877")),p=Object(h["a"])(f,r,n,!1,null,"66e66149",null);e["default"]=p.exports}}]);