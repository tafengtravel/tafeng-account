(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-95381a4c"],{7323:function(t,e,a){"use strict";a("f884")},8965:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"開始日期","end-placeholder":"結束日期","value-format":"yyyy-MM-dd"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"請輸入團名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜尋")]),a("el-row"),a("div",{staticClass:"el-col-24"},[a("div",{staticClass:"sub_title"},[t._v("當日業績")]),a("el-row"),a("el-row",[a("span",{staticClass:"font el-col-4 el-col-sm-12 el-col-xs-12 el-col-xl-4 el-col-lg-4"},[a("font",{attrs:{color:"black"}},[t._v("人數："+t._s(t.amountTotal))])],1),a("span",{staticClass:"font el-col-4 el-col-sm-12 el-col-xs-12 el-col-xl-4 el-col-lg-4"},[a("font",{attrs:{color:"black"}},[t._v("營業額："+t._s(t.priceTotal))])],1),a("span",{staticClass:"font el-col-4 el-col-sm-12 el-col-xs-12 el-col-xl-4 el-col-lg-4"},[a("font",{attrs:{color:"black"}},[t._v("利潤："+t._s(t.profitTotal))])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"show-summary":"","summary-method":t.getSummaries,data:t.itemData.filter((function(e){return!t.name||e.name.toLowerCase().includes(t.name.toLowerCase())})),"default-sort":{prop:"number",order:"ascending"},"row-class-name":t.tableRowClassName,"empty-text":"沒有資料"}},[a("el-table-column",{attrs:{type:"index",label:"筆數",width:"75%",fixed:""}}),a("el-table-column",{attrs:{prop:"number",label:"團號",width:"140%",sortable:"","sort-method":function(t,e){return t.number.localeCompare(e.number)}}}),a("el-table-column",{attrs:{prop:"group",label:"團體",width:"90%",formatter:t.group,sortable:"","sort-method":function(t,e){return t.group-e.group}}}),a("el-table-column",{attrs:{prop:"cs",label:"客服",width:"75%"}}),a("el-table-column",{attrs:{prop:"depDate",label:"出發日期",width:"120%",sortable:"","sort-method":function(t,e){return t.depDate.localeCompare(e.depDate)}}}),a("el-table-column",{attrs:{prop:"endDate",label:"結束日期",width:"120%",sortable:"","sort-method":function(t,e){return t.endDate.localeCompare(e.endDate)}}}),a("el-table-column",{attrs:{prop:"name",label:"團名",sortable:"","sort-method":function(t,e){return t.name.localeCompare(e.name)}}}),a("el-table-column",{attrs:{prop:"people",label:"代表人",width:"175%",sortable:"","sort-method":function(t,e){return t.people.localeCompare(e.people)}}}),a("el-table-column",{attrs:{prop:"amount",label:"人數",width:"90%",sortable:"","sort-method":function(t,e){return t.amount.localeCompare(e.amount)}}}),a("el-table-column",{attrs:{prop:"other",label:"備註",width:"200%"}}),a("el-table-column",{attrs:{prop:"createDate",label:"報帳日期",sortable:"","sort-method":function(t,e){return t.createDate.localeCompare(e.createDate)},width:"120%"}}),a("el-table-column",{attrs:{prop:"profit",label:"利潤",width:"100%",formatter:t.profitCheck}}),a("el-table-column",{attrs:{prop:"priceDetailAdminCheck",label:"主管核實",width:"100%",formatter:t.adminCheck}}),a("el-table-column",{attrs:{prop:"incomeDetailOpCheck[0]",label:"OP核實",width:"100%",formatter:t.opCheck}}),a("el-table-column",{attrs:{prop:"",label:"編輯",width:"60%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.edit(e.row)}}},[t._v("編輯")])]}}])})],1),a("el-row"),a("div",{staticStyle:{"text-align":"right"}},[a("GenerateFolderCover",{attrs:{fotherItemData:t.itemData}})],1),a("el-row"),a("div",{staticClass:"sub_title"},[t._v("退業績")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.itemDataCancel,"default-sort":{prop:"number",order:"ascending"},"row-class-name":t.tableRowClassName,"empty-text":"沒有資料"}},[a("el-table-column",{attrs:{type:"index",label:"筆數",width:"75%",fixed:""}}),a("el-table-column",{attrs:{prop:"number",label:"團號",width:"140%",sortable:"","sort-method":function(t,e){return t.number.localeCompare(e.number)}}}),a("el-table-column",{attrs:{prop:"group",label:"團體",width:"90%",formatter:t.group,sortable:"","sort-method":function(t,e){return t.group-e.group}}}),a("el-table-column",{attrs:{prop:"cs",label:"客服",width:"75%"}}),a("el-table-column",{attrs:{prop:"depDate",label:"出發日期",width:"120%",sortable:"","sort-method":function(t,e){return t.depDate.localeCompare(e.depDate)}}}),a("el-table-column",{attrs:{prop:"endDate",label:"結束日期",width:"120%",sortable:"","sort-method":function(t,e){return t.endDate.localeCompare(e.endDate)}}}),a("el-table-column",{attrs:{prop:"name",label:"團名",sortable:"","sort-method":function(t,e){return t.name.localeCompare(e.name)}}}),a("el-table-column",{attrs:{prop:"people",label:"代表人",width:"175%",sortable:"","sort-method":function(t,e){return t.people.localeCompare(e.people)}}}),a("el-table-column",{attrs:{prop:"amount",label:"人數",width:"90%",sortable:"","sort-method":function(t,e){return t.amount.localeCompare(e.amount)}}}),a("el-table-column",{attrs:{prop:"createDate",label:"報帳日期",width:"120%"}}),a("el-table-column",{attrs:{prop:"priceDetailAdminCheck",label:"主管核實",width:"100%",formatter:t.adminCheck}}),a("el-table-column",{attrs:{prop:"incomeDetailIncome[0]",label:"收入",width:"100%"}}),a("el-table-column",{attrs:{prop:"incomeDetailOpCheck[0]",label:"OP核實",width:"100%",formatter:t.opCheck}}),a("el-table-column",{attrs:{prop:"",label:"編輯",width:"60%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.edit(e.row)}}},[t._v("編輯")])]}}])})],1)],1)],1)},l=[],r=a("5530"),n=(a("d3b7"),a("159b"),a("d81d"),a("a434"),a("17e1")),i=(a("2a70"),a("c1df")),c=(a("ed08"),a("a3bf")),s={components:{GenerateFolderCover:c["a"]},data:function(){return{listLoading:!1,itemData:[],itemDataCancel:[],date:"",amountTotal:"",profitTotal:"",priceTotal:"",name:""}},created:function(){},methods:{getSummaries:function(t){var e=t.columns,a=t.data,o=[];return e.forEach((function(t,e){if(0!==e)if("人數"==t.label||"利潤"==t.label){var l=a.map((function(e){return parseInt(e[t.property])}));l.every((function(t){return isNaN(t)}))||(o[e]=l.reduce((function(t,e){var a=parseInt(e);return isNaN(a)?t:t+e}),0))}else o[e]="";else o[e]="總共"})),o},profitCheck:function(t){return"跨年"!=t.location&&"團體報帳"!=t.location&&"JOIN報帳"!=t.location?t.profit:t.profit=0},adminCheck:function(t,e){return t.priceDetailAdminCheck?"✔️":"❌"},opCheck:function(t,e){return t.incomeDetailOpCheck[0]?"✔️":"❌"},group:function(t,e){return t.tax>0&&"跨年"!=t.location&&"團體報帳"!=t.location&&"JOIN報帳"!=t.location?"✔️":""},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"color-row":""},search:function(){var t=this;this.listLoading=!0;var e,a=0,o=i(this.date[0]).subtract(12,"months").format("YYYY-MM");this.itemData.splice(0,this.itemData.length),this.itemDataCancel.splice(0,this.itemDataCancel.length),this.amountTotal=0,this.profitTotal=0,this.priceTotal=0;for(var l=i(this.date[0]),c=i(this.date[1]),s=c.diff(l,"days")+1,p=this.date[0],u=0;u<24;u++){e=n["a"].collection(o),console.log(o),l=this.date[0];for(var d=0;d<s;d++)e.where("createDate","==",l).get().then((function(e){e.forEach((function(e){a=parseInt(e.data().price)-parseInt(e.data().income),t.itemData.push(Object(r["a"])(Object(r["a"])({},e.data()),{},{priceInsufficient:a})),isNaN(parseFloat(e.data().amount))||(t.amountTotal=parseFloat(t.amountTotal)+parseFloat(e.data().amount)),isNaN(parseFloat(e.data().price))||(t.priceTotal=parseFloat(t.priceTotal)+parseFloat(e.data().price)),"跨年"!=e.data().location&&"團體報帳"!=e.data().location&&"JOIN報帳"!=e.data().location&&(isNaN(parseFloat(e.data().profit))||(t.profitTotal=parseFloat(t.profitTotal)+parseFloat(e.data().profit)))})),t.listLoading=!1})),e.where("cancelDate","==",l).get().then((function(e){e.forEach((function(e){a=parseInt(e.data().price)-parseInt(e.data().income),t.itemDataCancel.push(Object(r["a"])(Object(r["a"])({},e.data()),{},{priceInsufficient:a}))})),p=i(p).add(1,"days").format("YYYY-MM-DD"),t.listLoading=!1})),l=i(l).add(1,"days").format("YYYY-MM-DD"),console.log(l);o=i(o).add(1,"months").format("YYYY-MM")}},edit:function(t){console.log(t);var e=this.$router.resolve({path:"/admin/edit/fit",query:{number:t.number,depDate:i(t.depDate).format("YYYY-MM-DD")}});window.open(e.href,"_blank")}},mounted:function(){}},p=s,u=(a("7323"),a("2877")),d=Object(u["a"])(p,o,l,!1,null,null,null);e["default"]=d.exports},f884:function(t,e,a){}}]);